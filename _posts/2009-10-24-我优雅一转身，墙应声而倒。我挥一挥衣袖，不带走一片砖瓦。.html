---
layout: post
status: publish
published: true
title: "我优雅一转身，墙应声而倒。我挥一挥衣袖，不带走一片砖瓦。"
author: Leask




author_login: leask
author_email: i@leaskh.com
author_url: https://leaskh.com
wordpress_id: 59
wordpress_url: http://leaskh.wordpress.com/2009/10/24/%e6%88%91%e4%bc%98%e9%9b%85%e4%b8%80%e8%bd%ac%e8%ba%ab%ef%bc%8c%e5%a2%99%e5%ba%94%e5%a3%b0%e8%80%8c%e5%80%92%e3%80%82%e6%88%91%e6%8c%a5%e4%b8%80%e6%8c%a5%e8%a1%a3%e8%a2%96%ef%bc%8c%e4%b8%8d%e5%b8%a6
date: '2009-10-24 08:14:28 +0800'
date_gmt: '2009-10-24 08:14:28 +0800'
categories:

tags: []
comments: []
---
<div id="msgcns!15BAC1A170471DB!15070" class="bvMsg">
<p><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="Screen shot 2009-10-24 at 4.04.09 PM" border="0" alt="Screen shot 2009-10-24 at 4.04.09 PM" src="/public/2010/09/screenshot2009-10-24at41.png?w=256" width="660" height="771" />&nbsp;</p>
<p>又到了周末翻墙的时间了。<br />使用了一段时间的ssh -D，我终于找回了做人的感觉，自由的空气如此新鲜，信息的绿洲让人神往，流连忘返。<br />ssh -D如此便利，速度如此流畅，让人印象深刻，但是美中不足的是每次都需要先连接，虽然上次已经分享过我写的一段脚本，实现在Mac上自动翻墙。但上次的脚本比较粗糙，仓促，于是又有了一些新的想法，目标是让翻墙更优雅、潇洒。</p>
<p>上次的版本是0.3，这次改动比较大我把版本设置为0.7，下面简单说一下几点改进：
<ol>
<li>自动判断在线状态，如果你还没有上网，是不会执行翻墙程序的；</li>
<li>自动判断翻墙结果，如果翻墙失败，程序将自动重新尝试；</li>
<li>自动更新动态IP，你或许在自己的电脑上使用OpenDNS，host网站，或者其他原因需要更新动态IP（近段时间我将发文谈谈Mac上动态IP的问题，请关注）；</li>
<li>自动执行程序，如果你有一些程序，如聊天软件，邮件检查软件等需要在上网的时候开启，也可以设定；</li>
<li>自动退出程序，如果你有一些程序，如邮件检查程序，Last.fm等，需要在断网的时候关闭，也可以设定；</li>
<li>设定是否在翻墙成功的时候更新Twitter状态；</li>
<li>全程语音提示，告诉你程序目前正在干什么，十分Cool；</li></ol>
<p>主要也就7点打改进，新的脚本还包含了错误语音提示，当过程中发生错误，将语音提醒你是什么原因发生错误。<br /><strong>十分建议把脚本设置为开机执行。</strong>
<p><font color="#ff0000">程序已经提交到Google Code，并开放源代码：<br />地址如下：</font><a title="http://code.google.com/p/flora-ssh-d/" href="http://code.google.com/p/flora-ssh-d/" target="_blank">http://code.google.com/p/flora-ssh-d/</a><font color="#ff0000"></font><br /><font color="#ff0000">注意！访问Google Code你可能需要先翻墙。</font>
<p>下面贴出源代码，大家粘贴到AppleScript Editor.app里面，修改参数然后执行就可以了。<br /><font color="#ff0000">有不明白的可以邮件或者GTalk联系我，我的邮件/GTalk/MSN/QQ同为：<a href="mailto:i@leaskh.com" target="_blank">i@leaskh.com</a> 。</font><br />
<blockquote>
<p>(* Flora_ssh-D // Version 0.7 // Code by Leask Huang // www.leaskh.com // i@leaskh.com *)
<p>(* ======= Variable Declaration ======= *)<br />global YourName<br />global SSHServerName -- SSH Server Name<br />global SSHLocalPorts -- Local Port<br />global SSHUserName -- User Name on SSH Server<br />global SSHPasswd -- Password for SSH Server<br />global TwitterAPI -- Twitter API URL<br />global TwitterUsername -- Twitter User Name<br />global TwitterPassword -- Twitter Password<br />global TwitterLogin<br />global TwitterStatus<br />global JobID<br />global URLTestNet<br />global URLTestGFW<br />global appDNSUpdate<br />global appStList<br />global appQuitList<br />global isConnected<br />global isSSHCnt<br />global isUpdateTwitter<br />global isRunExSoft<br />global isQuitExSoftware<br />global isUpdateDNS<br />global isDelnohup<br />global strnohup<br />global timeTry<br />global isforceQuit
<p>(* ======= General Settings ======= *)<br />(* You don't need to change these normally *)<br />set URLTestGFW to "twitter.com" -- Use this URL to check is your are Blocked by GFW<br />set URLTestNet to "leask.com" -- Use this URL to check if you are online<br />set SSHLocalPort to "7070" -- Set Socks 5 local port<br />set TwitterAPI to "<a href="https://twitter.com/statuses/update.json"">https://twitter.com/statuses/update.json"</a> -- Twitter API URL<br />-- set TwitterAPI to "<a href="http://twitter.com/statuses/update.json"">http://twitter.com/statuses/update.json"</a> -- Simple HTTP Twitter API URL (NOT Recommend)<br />set isDelnohup to true -- Set it as true to del SSH output informtions every time<br />set strnohup to "Downloads/.Flora_ssh-D.out" -- Config your SSH output file location<br />set isUpdateDNS to true -- Config if you want to update your dynamic IP address for OpenDNS / DLinkDDNS / DynDNS<br />set isUpdateTwitter to true -- Config if you want to update Twitter status every time<br />set isRunExSoft to true -- Config if you want to launch some aplications when you are online<br />set isQuitExSoftware to true -- Config if you want to quit some aplications when you are offline
<p>(* ======= User Settings ======= *)<br />(* Custom these before you run this script *)<br />set SSHServerName to "***.*******.com" -- Set ServerName, You must set this<br />set SSHUserName to "*******" -- Set UserName, You must set this<br />set SSHPasswd to "*******" -- Set Password, You must set this<br />set TwitterUsername to "" -- If you don't want to update Twitter status, leave it blank<br />set TwitterPassword to "" -- same as above<br />set TwitterText to "@" &amp; TwitterUsername &amp; " is online now! // " &amp; (current date) -- same as above<br />set appDNSUpdate to "DNS-O-Matic Updater" -- Use this application to update your dynamic IP address (or leave it blank)<br />set appStList to &#123;"Adium", "CoverSutra", "Google Notifier"&#125; -- these aplications will launch while you are online (or leave it blank)<br />set appQuitList to &#123;"CoverSutra", "Google Notifier"&#125; -- these aplications will quit while you are offline (or leave it blank)
<p>(* ======= Main Script ======= *)<br />set isConnected to false<br />set isSSHCnt to false<br />set timeTry to 0<br />set isforceQuit to false
<p>try<br />&nbsp;&nbsp;&nbsp; do shell script "curl " &amp; URLTestNet<br />&nbsp;&nbsp;&nbsp; set isConnected to true<br />on error<br />&nbsp;&nbsp;&nbsp; set isConnected to true -- false<br />&nbsp;&nbsp;&nbsp; say "Opps! Your internet isn't ready."<br />&nbsp;&nbsp;&nbsp; if (isQuitExSoftware is true) and ((count appQuitList) > 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat with intSti from 1 to count appQuitList<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application (item intSti of appQuitList)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end repeat<br />&nbsp;&nbsp;&nbsp; end if<br />end try
<p>if isConnected is true then<br />&nbsp;&nbsp;&nbsp; repeat while isSSHCnt is false<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "System Events"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if exists process "Terminal" then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isUpdateDNS is true) and ((length of appDNSUpdate) > 0) and (timeTry is 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application appDNSUpdate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isDelnohup is true) and (timeTry is 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script "rm ~/" &amp; strnohup in window 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script "killall ssh" in window 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script "killall ssh-agent" in window 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script "nohup ssh -D " &amp; SSHLocalPort &amp; " " &amp; SSHUserName &amp; "@" &amp; SSHServerName &amp; " > " &amp; strnohup in window 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if timeTry is 0 then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Hi, " &amp; (short user name of (system info)) &amp; ". I am your Mac. I am configuring the network for you."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isUpdateDNS is true then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Update DNS"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to JobID + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to JobID + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Update DNS"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to JobID + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Get ready to retry."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script SSHPasswd in window 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Create SSH D connection"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "curl --socks5 127.0.0.1:" &amp; SSHLocalPort &amp; " " &amp; URLTestGFW<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "OK! SSH D has been successfully connected."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set isSSHCnt to true<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on error<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set isSSHCnt to false<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Opps! SSH D connection fail."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (button returned of (display dialog "Opps! ssh -D connection fail. Do you want to retry?" &amp; return &amp; "" buttons &#123;"Retry", "Quit"&#125;)) is "Retry" then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set timeTry to timeTry + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exit repeat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br />&nbsp;&nbsp;&nbsp; end repeat<br />&nbsp;&nbsp;&nbsp; if isSSHCnt is true then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isUpdateTwitter is true) and ((length of TwitterUsername) > 0) and ((length of SSHPasswd) > 0) and ((length of TwitterText) > 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to JobID + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Update twitter state"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set TwitterLogin to quoted form of (TwitterUsername &amp; ":" &amp; TwitterPassword)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set TwitterStatus to quoted form of ("status=" &amp; TwitterText)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "curl --user " &amp; TwitterLogin &amp; " --data-binary " &amp; TwitterStatus &amp; " " &amp; TwitterAPI<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "OK! Twitter state has been successfully updated."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on error<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Opps! Error while updating Twitter state."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isRunExSoft is true) and ((count appStList) > 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set JobID to JobID + 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say "Process " &amp; JobID &amp; ": Start Applications"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat with intSti from 1 to count appStList<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application (item intSti of appStList)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; activate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end repeat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp; tell application "Terminal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit<br />&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp; if (isUpdateDNS is true) and ((length of appDNSUpdate) > 0) then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application appDNSUpdate<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br />&nbsp;&nbsp;&nbsp; end if<br />&nbsp;&nbsp;&nbsp; say "All done! Bye!"<br />end if</p></p></blockquote>  </p></div></p>
